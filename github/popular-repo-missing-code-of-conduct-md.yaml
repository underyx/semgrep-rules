rules:
- id: popular-repo-missing-code-of-conduct-md
  languages:
  - json
  message: >-
    The $NAME repo is popular (has $STAR_COUNT stars) but has no code of conduct.
    Add a CODE_OF_CONDUCT.md via $URL/community/code-of-conduct/new
  metadata:
    supersemgrep.loader: github_repos
  patterns:
  - pattern-inside: >-
      {
        "__typename": "Repository",
        "nameWithOwner": "$NAME",
        "isArchived": false,
        "isPrivate": false,
        "stargazerCount": $STAR_COUNT,
        "url": "$URL",
        ...
      }
  - metavariable-comparison:
      metavariable: $STAR_COUNT
      comparison: $STAR_COUNT >= 100
  - pattern: '"codeOfConduct": null'
  severity: ERROR
